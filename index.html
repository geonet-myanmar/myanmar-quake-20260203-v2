<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Myanmar Seismicity & Tectonics Map</title>
    
    <!-- Leaflet CSS -->
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
    <!-- Tailwind for UI -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <style>
        body, html { margin: 0; padding: 0; height: 100%; overflow: hidden; }
        #map { height: 100vh; width: 100%; background: #e5e7eb; }
        
        /* Pulse Animation for Epicenters */
        .pulse {
            display: block;
            width: 18px;
            height: 18px;
            border-radius: 50%;
            cursor: pointer;
            box-shadow: 0 0 0 rgba(239, 68, 68, 0.4);
            animation: pulse 2s infinite;
        }

        @keyframes pulse {
            0% { box-shadow: 0 0 0 0 rgba(239, 68, 68, 0.7); }
            70% { box-shadow: 0 0 0 15px rgba(239, 68, 68, 0); }
            100% { box-shadow: 0 0 0 0 rgba(239, 68, 68, 0); }
        }

        .custom-scrollbar::-webkit-scrollbar { width: 4px; }
        .custom-scrollbar::-webkit-scrollbar-track { background: transparent; }
        .custom-scrollbar::-webkit-scrollbar-thumb { background: #cbd5e1; border-radius: 10px; }

        .leaflet-popup-content-wrapper {
            background: #ffffff;
            color: #1f2937;
            border-radius: 12px;
            padding: 0;
            overflow: hidden;
        }
        .leaflet-popup-content { margin: 0; width: 200px !important; }
    </style>
</head>
<body class="bg-gray-50 text-gray-900 font-sans">

    <!-- Top Navigation -->
    <nav class="absolute top-0 left-0 right-0 z-[1001] bg-white/80 backdrop-blur-md border-b border-gray-200 px-4 py-3 flex justify-between items-center shadow-sm">
        <div>
            <h1 class="text-lg font-bold flex items-center gap-2 text-gray-800">
                <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="text-red-600"><path d="M2 12h5l2 8 5-16 2 8h5"/></svg>
                Myanmar Seismic Activity
            </h1>
            <p class="text-[10px] text-gray-500 font-medium uppercase tracking-tighter">Live Monitor • Feb 03, 2026</p>
        </div>
        <div class="flex gap-2">
            <button onclick="resetView()" class="bg-white hover:bg-gray-50 text-xs px-3 py-1.5 rounded-lg border border-gray-200 shadow-sm transition-all text-gray-700 font-semibold">Center Cluster</button>
        </div>
    </nav>

    <!-- Side Panel -->
    <aside class="absolute top-20 left-4 z-[1000] w-80 max-h-[calc(100vh-120px)] bg-white/95 backdrop-blur-md border border-gray-200 rounded-2xl overflow-hidden shadow-2xl flex flex-col">
        <div class="p-4 border-b border-gray-100 bg-gray-50/50">
            <h2 class="font-bold text-xs uppercase tracking-widest text-gray-400">Earthquake Sequence</h2>
        </div>
        
        <div class="flex-1 overflow-y-auto custom-scrollbar p-4 space-y-6">
            
            <!-- Event 1: M 5.9 -->
            <div class="group cursor-pointer" onclick="focusQuake(20.466, 93.957)">
                <div class="flex justify-between items-start mb-2">
                    <span class="px-2 py-0.5 rounded text-[10px] font-bold bg-red-600 text-white">MAG 5.9</span>
                    <span class="text-[10px] text-gray-400 font-mono">22:04 MMT</span>
                </div>
                <div class="bg-red-50/50 p-3 rounded-xl border border-red-100 group-hover:border-red-300 transition-colors">
                    <p class="text-sm font-bold text-red-900 mb-1">95 km W of Yenangyaung</p>
                    <div class="flex gap-4">
                        <div>
                            <p class="text-[9px] text-red-400 uppercase font-bold">Depth</p>
                            <p class="text-sm font-bold text-red-700">62.7 <span class="text-[10px] font-normal">km</span></p>
                        </div>
                        <div>
                            <p class="text-[9px] text-red-400 uppercase font-bold">Status</p>
                            <p class="text-sm font-bold text-green-600">PAGER Green</p>
                        </div>
                    </div>
                </div>
            </div>

            <div class="border-t border-gray-100"></div>

            <!-- Event 2: M 5.2 -->
            <div class="group cursor-pointer" onclick="focusQuake(20.554, 94.024)">
                <div class="flex justify-between items-start mb-2">
                    <span class="px-2 py-0.5 rounded text-[10px] font-bold bg-orange-500 text-white">MAG 5.2</span>
                    <span class="text-[10px] text-gray-400 font-mono">22:21 MMT</span>
                </div>
                <div class="bg-orange-50/50 p-3 rounded-xl border border-orange-100 group-hover:border-orange-300 transition-colors">
                    <p class="text-sm font-bold text-orange-900 mb-1">88 km W of Yenangyaung</p>
                    <div class="flex gap-4">
                        <div>
                            <p class="text-[9px] text-orange-400 uppercase font-bold">Depth</p>
                            <p class="text-sm font-bold text-orange-700">67.8 <span class="text-[10px] font-normal">km</span></p>
                        </div>
                        <div>
                            <p class="text-[9px] text-orange-400 uppercase font-bold">Region</p>
                            <p class="text-sm font-bold text-gray-700">Burma</p>
                        </div>
                    </div>
                </div>
            </div>

            <div class="pt-4 border-t border-gray-100">
                <h3 class="text-[10px] text-gray-400 uppercase font-bold mb-3 tracking-widest">Map Legend</h3>
                <div class="space-y-3 text-xs text-gray-600">
                    <div class="flex items-center gap-3">
                        <span class="w-3 h-3 rounded-full bg-red-600 shadow-lg shadow-red-200"></span>
                        <span>Major Event (>M5.5)</span>
                    </div>
                    <div class="flex items-center gap-3">
                        <span class="w-3 h-3 rounded-full bg-orange-500 shadow-lg shadow-orange-200"></span>
                        <span>Moderate Event</span>
                    </div>
                    <div class="flex items-center gap-3">
                        <span class="w-4 h-0.5 bg-[#5D4037]"></span>
                        <span>Tectonic Fault Lines</span>
                    </div>
                </div>
            </div>
        </div>
        
        <div class="p-4 bg-gray-50 text-[10px] text-gray-400 text-center border-t border-gray-100">
            Source: USGS Earthquake Catalog • drtinkooo
        </div>
    </aside>

    <div id="map"></div>

    <!-- Leaflet JS -->
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>

    <script>
        // Data Definitions
        const quakes = [
            {
                mag: 5.9,
                lat: 20.466,
                lon: 93.957,
                depth: 62.7,
                time: "22:04:01 MMT",
                location: "95 km W of Yenangyaung",
                color: "#dc2626"
            },
            {
                mag: 5.2,
                lat: 20.554,
                lon: 94.024,
                depth: 67.8,
                time: "22:21:30 MMT",
                location: "88 km W of Yenangyaung",
                color: "#f97316"
            }
        ];

        const geojsonUrl = 'https://raw.githubusercontent.com/drtinkooo/myanmar-earthquake-archive/main/Myanmar_Tectonic_Map_2011.geojson';

        // Initialize Map
        const map = L.map('map', { 
            zoomControl: false,
            attributionControl: true 
        }).setView([20.5, 94.0], 6);

        // OSM Layer
        L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
            maxZoom: 18,
            attribution: '© OpenStreetMap'
        }).addTo(map);

        L.control.zoom({ position: 'bottomright' }).addTo(map);
        L.control.scale({ position: 'bottomright', imperial: false }).addTo(map);

        const markers = [];
        const group = new L.featureGroup();

        // Add Earthquake Markers
        quakes.forEach(q => {
            const icon = L.divIcon({
                className: 'custom-div-icon',
                html: `<div class="pulse" style="background: ${q.color}; box-shadow: 0 0 10px ${q.color}66"></div>`,
                iconSize: [20, 20],
                iconAnchor: [10, 10]
            });

            const marker = L.marker([q.lat, q.lon], { icon }).addTo(map);
            
            const popup = `
                <div class="overflow-hidden font-sans">
                    <div class="p-3 bg-gray-50 border-b border-gray-100">
                        <h4 class="text-xs font-black uppercase tracking-widest text-gray-400">Earthquake</h4>
                        <div class="text-lg font-black" style="color: ${q.color}">MAGNITUDE ${q.mag}</div>
                    </div>
                    <div class="p-3 space-y-2">
                        <div class="flex justify-between items-center text-[10px]">
                            <span class="text-gray-400 uppercase font-bold">Time</span>
                            <span class="font-mono font-bold text-gray-700">${q.time}</span>
                        </div>
                        <div class="flex justify-between items-center text-[10px]">
                            <span class="text-gray-400 uppercase font-bold">Depth</span>
                            <span class="font-bold text-gray-700">${q.depth} km</span>
                        </div>
                        <div class="pt-2 text-[10px] text-gray-500 italic border-t border-gray-50">
                            ${q.location}
                        </div>
                    </div>
                </div>
            `;
            
            marker.bindPopup(popup);
            group.addLayer(marker);
            markers.push(marker);
        });

        // Load Tectonic Lines
        fetch(geojsonUrl)
            .then(res => res.json())
            .then(data => {
                L.geoJSON(data, {
                    style: (feature) => ({
                        color: '#5D4037',
                        weight: 2,
                        opacity: 0.5,
                        dashArray: feature.properties.TYPE === 'Inferred' ? '4, 4' : null
                    }),
                    onEachFeature: (feature, layer) => {
                        layer.bindPopup(`<div class="p-2 text-xs font-bold text-gray-700">${feature.properties.NAME || 'Fault Line'}</div>`);
                        layer.on('mouseover', function() { this.setStyle({ opacity: 1, weight: 3 }); });
                        layer.on('mouseout', function() { this.setStyle({ opacity: 0.5, weight: 2 }); });
                    }
                }).addTo(map);
            });

        // Fit map to markers with wider padding to zoom out more
        map.fitBounds(group.getBounds(), { padding: [120, 120] });

        function resetView() {
            map.flyToBounds(group.getBounds(), { duration: 1.2, padding: [120, 120] });
        }

        function focusQuake(lat, lon) {
            // Lowered zoom level to 8 for more regional context when focusing
            map.flyTo([lat, lon], 8, { duration: 1.5 });
        }

        window.addEventListener('resize', () => map.invalidateSize());
    </script>
</body>
</html>